# E2Eテストシナリオ一覧

このドキュメントは、`nuxt-livesync` プロジェクトに実装されているE2E（エンドツーエンド）テストのシナリオをまとめたものです。
テストは `/test/e2e/` ディレクトリに格納されています。

---

## 1. `index.spec.ts` (トップページ)

観客が最初にアクセスするトップページに関するテストです。

- **ページタイトルの確認**: ページを開いた際に、タイトルが正しく `LiveSync` を含んでいることを確認します。
- **初期表示の確認**: ページに「Waiting...」という見出しが表示されており、演出を待っている状態であることを確認します。

---

## 2. `auth.spec.ts` (認証機能)

管理者向けのログイン・ログアウトといった認証フローに関するテストです。

- **正常なログイン・ログアウト**:
    - 有効なメールアドレスとパスワードでログインできること。
    - ログイン後、演出管理ページ (`/admin/cues`) にリダイレクトされること。
    - ログアウトボタンをクリックすると、正常にログアウトしてログインページに戻ること。
- **不正なログイン試行**:
    - 無効な認証情報でログインしようとすると、失敗してエラーメッセージが表示されること。
- **未認証時のアクセス制御**:
    - ログインしていない状態で管理ページ (`/admin/cues`, `/admin/onair`) にアクセスしようとすると、自動的にログインページにリダイレクトされること。
- **認証時のアクセス制御**:
    - すでにログインしている状態でログインページにアクセスしようとすると、自動的に演出管理ページ (`/admin/cues`) にリダイレクトされること。

---

## 3. `cues.spec.ts` (演出管理機能)

演出の作成、編集、削除（CRUD操作）が正しく行えるかを確認するテストです。

- **演出の新規作成**:
    - 「新規演出を追加」ボタンから、新しい演出（テスト用の単色カラー）を登録できること。
    - 登録後、一覧に新しい演出が追加されていることを確認します。
- **演出の編集**:
    - 作成した演出の「編集」ボタンを押し、演出名を変更して保存できること。
    - 保存後、一覧の表示が更新されていることを確認します。
- **演出の削除**:
    - 編集した演出の「削除」ボタンを押し、確認ダイアログを経て削除できること。
    - 削除後、一覧からその演出が消えていることを確認します。

---

## 4. `onair.spec.ts` (本番操作機能)

本番操作ページで、演出を正常に実行できるかを確認するテストです。

- **演出の実行**:
    - 事前にテスト用の演出データをデータベースに作成します。
    - 本番操作ページ (`/admin/onair`) を開き、テスト用演出のボタンをクリックします。
    - クリック後、画面に「成功」の通知が表示されることを確認します。
    - データベース上で、現在の演出ID (`active_cue_id`) が正しく更新されていることを確認します。

---

## 5. `sync.spec.ts` (リアルタイム同期)

管理者の操作が、観客側の画面にリアルタイムで反映されるかを確認するテストです。

- **管理者と観客の画面同期**:
    - 「管理者」と「観客」の2つの仮想ブラウザを同時に起動します。
    - 管理者側が本番操作ページで特定の演出（テスト用の背景色変更）を実行します。
    - 観客側の画面で、「Waiting...」の表示が消え、指定された背景色にリアルタイムで切り替わることを確認します。